#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include "xor.h"


uint8_t* xor(uint8_t* data, uint32_t data_size ,uint8_t* key, uint32_t key_size){


    uint8_t* transformed_data = malloc(sizeof(uint8_t) * (data_size+1));

    transformed_data[data_size] = '\0';


    for(int i = 0; i < data_size; i++){
        transformed_data[i] = data[i] ^ key[i%key_size];
    }

    return transformed_data;
}

int main(int argc, char const *argv[])
{   

    uint8_t* decrypted_data = (uint8_t *) "this is data\0"; // 12
    uint8_t* key            = (uint8_t *) "key\0"; // 3

    uint8_t* encrypted_data = xor(decrypted_data, 12, key, 3);
    
    for(int i = 0; i < 12; i++){
        printf("%x ", encrypted_data[i]);
    }



    return 0;
}
